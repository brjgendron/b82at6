(()=>{function e(e){let s={container:{html:document.createElement("li"),class:"message"}};for(var t=1;t<arguments.length;t++)s[`domObj${t}`]={html:document.createElement(Object.values(arguments[t])[0]),class:Object.values(arguments[t])[1],contents:Object.values(arguments[t])[2]};const n=Object.values(s);for(var l=0;l<n.length;l++){if(l<n.length-1){let e=l;n[0].html.appendChild(n.slice(1)[e].html)}""!==n[l].class&&(n[l].html.classList.add(n[l].class),n[l].class===e.id&&n[l].html.setAttribute("style",`color: ${e.color}; font-weight: 500;`)),null!=n[l].contents&&n[l].html.appendChild(document.createTextNode(n[l].contents))}return s.container.html}function s(e,s){let t;for(;e.firstChild;)e.removeChild(e.firstChild);for(var n=0;n<s.length;n++)t=document.createElement("li"),t.classList.add(s[n].id),t.setAttribute("style",`color: ${s[n].color}; font-weight: 500`),t.appendChild(document.createTextNode(s[n].username)),e.appendChild(t)}var t=io();const n=2500,l=25;let a=document.querySelector("#messages"),c=document.querySelector("#users"),o=document.querySelector("#chatbox"),r=document.getElementsByClassName("server-name");document.getElementsByClassName("expand-icon"),document.getElementsByClassName("collapse-icon");for(var d=0;d<r.length;d++){let e=r[d];r[d].addEventListener("click",s=>{e.classList.contains("expanded")?(e.classList.add("collapsed"),e.classList.remove("expanded"),e.children[0].classList.add("hidden"),e.children[1].classList.remove("hidden"),e.nextElementSibling.classList.add("hidden")):e.classList.contains("collapsed")&&(e.classList.add("expanded"),e.classList.remove("collapsed"),e.children[0].classList.remove("hidden"),e.children[1].classList.add("hidden"),e.nextElementSibling.classList.remove("hidden"))})}document.querySelector("#compose").addEventListener("submit",e=>{e.preventDefault(),o.value.length>0&&o.value.length<=n?(t.emit("chat.message",o.value),o.value=""):o.value.length>n&&alert(`Your message exceeds the character limit of ${n}`)}),t.on("user.connect",(n,o)=>{document.querySelector("#change-username").onclick=(e=>{e.preventDefault();let s=prompt("Enter a new username");s.length>0&&s.length<=25?t.emit("user.setusername",s,o):s.length>l&&alert("Your username exceeds the character limit of "+l)}),s(c,n),a.appendChild(e(o,{html:"span",class:"",contents:"User "},{html:"span",class:o.id,contents:o.id},{html:"span",class:"",contents:" has connected"})),console.log(`user ${o.username} has connected`)}),t.on("user.setusername",(t,n,l)=>{n.id!=l?a.appendChild(e(n,{html:"span",class:"",contents:"User "},{html:"span",class:n.id,contents:`${l} (${n.id})`},{html:"span",class:"",contents:" has changed their username to "},{html:"span",class:n.id,contents:n.username})):a.appendChild(e(n,{html:"span",class:"",contents:"User "},{html:"span",class:n.id,contents:n.id},{html:"span",class:"",contents:" has changed their username to "},{html:"span",class:n.id,contents:n.username})),s(c,t)}),t.on("chat.message",s=>{a.appendChild(e({id:s.senderID,username:s.senderUsername,color:s.senderColorHSL},{html:"span",class:"message-timestamp",contents:`[${s.messageTimestamp}] `},{html:"span",class:s.senderID,contents:s.senderUsername},{html:"span",class:"message-text",contents:`: ${s.contents}`})),document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollTop=document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollHeight,console.log(s)}),t.on("garbage test",s=>{console.log(s.senderID),a.appendChild(e({id:s.senderID,username:s.senderUsername,color:s.senderColorHSL},{html:"span",class:"message-timestamp",contents:`[${s.messageTimestamp}] `},{html:"span",class:s.senderID,contents:s.senderUsername},{html:"span",class:"message-text",contents:`: ${s.contents}`})),document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollTop=document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollHeight}),t.on("user.disconnect",(t,n)=>{s(c,t),a.appendChild(e(n,{html:"span",class:"",contents:"User "},{html:"span",class:n.id,contents:n.id},{html:"span",class:"",contents:" has disconnected"})),console.log(`user ${n.username} (${n.id}) has disconnected`)})})();