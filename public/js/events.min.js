(()=>{function e(e){let s={container:{html:document.createElement("li"),class:"message"}};for(var t=1;t<arguments.length;t++)s[`domObj${t}`]={html:document.createElement(Object.values(arguments[t])[0]),class:Object.values(arguments[t])[1],contents:Object.values(arguments[t])[2]};const n=Object.values(s);for(var l=0;l<n.length;l++){if(l<n.length-1){let e=l;n[0].html.appendChild(n.slice(1)[e].html)}""!==n[l].class&&(n[l].html.classList.add(n[l].class),n[l].class===e.id&&n[l].html.setAttribute("style",`color: ${e.color}; font-weight: 500;`)),null!=n[l].contents&&n[l].html.appendChild(document.createTextNode(n[l].contents))}return s.container.html}function s(e,s){let t;for(;e.firstChild;)e.removeChild(e.firstChild);for(var n=0;n<s.length;n++)t=document.createElement("li"),t.classList.add(s[n].id),t.setAttribute("style",`color: ${s[n].color}; font-weight: 500`),t.appendChild(document.createTextNode(s[n].username)),e.appendChild(t)}var t=io();const n=2500;let l=document.querySelector("#messages"),a=(JSON.parse(decodeURIComponent(document.cookie).split("user=j:",-1)[1]),document.querySelector("#users")),c=document.querySelector("#chatbox"),o=document.getElementsByClassName("server-name");document.getElementsByClassName("expand-icon"),document.getElementsByClassName("collapse-icon");for(var d=0;d<o.length;d++){let e=o[d];o[d].addEventListener("click",s=>{e.classList.contains("expanded")?(e.classList.add("collapsed"),e.classList.remove("expanded"),e.children[0].classList.add("hidden"),e.children[1].classList.remove("hidden"),e.nextElementSibling.classList.add("hidden")):e.classList.contains("collapsed")&&(e.classList.add("expanded"),e.classList.remove("collapsed"),e.children[0].classList.remove("hidden"),e.children[1].classList.add("hidden"),e.nextElementSibling.classList.remove("hidden"))})}document.querySelector("#compose").addEventListener("submit",e=>{e.preventDefault(),c.value.length>0&&c.value.length<=n?(t.emit("message",c.value),c.value=""):c.value.length>n&&alert(`Your message exceeds the character limit of ${n}`)}),t.on("new connection",(t,n)=>{s(a,n),l.appendChild(e(t,{html:"span",class:"",contents:"User "},{html:"span",class:t.id,contents:`${t.username}-${t.id}`},{html:"span",class:"",contents:" has connected"}))}),t.on("message",s=>{l.appendChild(e({id:s.senderID,username:s.senderUsername,color:s.senderColorHSL},{html:"span",class:"message-timestamp",contents:`[${s.messageTimestamp}] `},{html:"span",class:s.senderID,contents:s.senderUsernameWithID},{html:"span",class:"message-text",contents:`: ${s.contents}`})),document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollTop=document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollHeight,console.log(s)}),t.on("show previous messages",s=>{l.appendChild(e({id:s.senderID,username:s.senderUsername,color:s.senderColorHSL},{html:"span",class:"message-timestamp",contents:`[${s.messageTimestamp}] `},{html:"span",class:s.senderID,contents:s.senderUsernameWithID},{html:"span",class:"message-text",contents:`: ${s.contents}`})),document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollTop=document.querySelector("#messages-container").SimpleBar.getScrollElement().scrollHeight}),t.on("user.disconnect",(t,n)=>{s(a,t),l.appendChild(e(n,{html:"span",class:"",contents:"User "},{html:"span",class:n.id,contents:n.id},{html:"span",class:"",contents:" has disconnected"})),console.log(`user ${n.username} (${n.id}) has disconnected`)})})();